<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:cm="clr-namespace:System.ComponentModel;assembly=System"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:local="clr-namespace:KompasTools" xmlns:viewmodels="clr-namespace:KompasTools.ViewModels"
        xmlns:WorkingWithFiles="clr-namespace:KompasTools.ViewModels.WorkingWithFiles" xmlns:Sundry="clr-namespace:KompasTools.ViewModels.Sundry" x:Class="KompasTools.MainWindow"
        xmlns:Welding="clr-namespace:KompasTools.Classes.Sundry.Welding"
        mc:Ignorable="d"
        Title="{Binding TitleMainWindow}" Height="{Binding HeightMainWindow, Mode=TwoWay}" Width="{Binding WidthMainWindow, Mode=TwoWay}"
        WindowStartupLocation="CenterScreen" WindowStyle="SingleBorderWindow" Topmost="{Binding IsChecked, ElementName=cb_Topmost}"
        MinHeight="850" MinWidth="990">
    <Window.Resources>
        <Welding:RadioBoolConverterToLocationPart x:Key="radioBoolConverterToLocationPart" />
        <Style TargetType="{x:Type TextBlock}">
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        <Style TargetType="{x:Type TextBox}">
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>
        <Style TargetType="{x:Type Border}">
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="Black"/>
        </Style>
    </Window.Resources>
    <Window.DataContext>
        <viewmodels:MainWindowViewModel/>
    </Window.DataContext>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName ="Closing">
            <i:InvokeCommandAction Command ="{Binding ClosingMainWindowCommand}"/>
        </i:EventTrigger>
        <i:EventTrigger EventName ="Loaded">
            <i:InvokeCommandAction Command ="{Binding LoadedMainWindowCommand}"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="25"/>
            <RowDefinition/>
            <RowDefinition Height="25"/>
        </Grid.RowDefinitions>
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
            <Menu>
                <MenuItem Header="Настройки">
                    <MenuItem Header="Обновление"/>
                </MenuItem>
            </Menu>
            <ToggleButton  x:Name="cb_Topmost" Content="Topmost" ToolTip="Включить/выключить режим поверх всех окон"
                           IsChecked="False" VerticalAlignment="Center"/>
        </StackPanel>
        <TabControl Grid.Row="1">
            <!--Работа с файлами-->
            <TabItem Header="Работа с файлами">
                <TabItem.DataContext>
                    <WorkingWithFiles:WorkingWithFilesViewModel/>
                </TabItem.DataContext>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="100"/>
                    </Grid.RowDefinitions>
                    <TabControl Grid.Row="0">
                        <!--Изменить штамп-->
                        <TabItem Header="Изменить штамп">
                            <TabItem.DataContext>
                                <WorkingWithFiles:EditStampViewModel/>
                            </TabItem.DataContext>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <StackPanel Grid.Row="0" Orientation="Vertical">
                                    <DockPanel LastChildFill="True">
                                        <TextBlock DockPanel.Dock="Top" Text="Получить чертежи:" Margin="2"/>
                                        <RadioButton IsChecked="{Binding IsFolderAllCdw}" DockPanel.Dock="Top" GroupName="Изменить штамп. Способ получения чертежей"
                                                     Content="из папки"/>
                                        <Button IsEnabled="{Binding IsFolderAllCdw}" DockPanel.Dock="Left" Width="Auto" Content="Выбрать папку" Padding="4,2" Margin="2"
                                                Command="{Binding OpenFolderCommand}"/>
                                        <TextBox IsEnabled="{Binding IsFolderAllCdw}" Text="{Binding PathFolderAllCdw}" DockPanel.Dock="Left" MinWidth="200" Margin="2,1"/>
                                    </DockPanel>
                                    <DockPanel LastChildFill="False">
                                        <RadioButton IsChecked="{Binding IsPathsFileCdw}" DockPanel.Dock="Top" GroupName="Изменить штамп. Способ получения чертежей"
                                                     Content="выбором файлов"/>
                                        <Button IsEnabled="{Binding IsPathsFileCdw}" DockPanel.Dock="Left" Width="Auto" Content="Выбрать чертежи" Padding="4,2" Margin="2"
                                                Command="{Binding GetPathFilesCommand}"/>
                                    </DockPanel>
                                    <TextBlock Text="Список чертежей для изменения:" Margin="2"/>
                                    <ListBox ItemsSource="{Binding PathsFileCdw}" Height="100"/>
                                </StackPanel>

                                <Grid Grid.Row="1"  Margin="10,10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="35"/>
                                        <ColumnDefinition Width="50"/>
                                        <ColumnDefinition Width="115"/>
                                        <ColumnDefinition Width="75"/>
                                        <ColumnDefinition Width="50"/>
                                        <ColumnDefinition Width="350"/>
                                        <ColumnDefinition Width="25"/>
                                        <ColumnDefinition Width="25"/>
                                        <ColumnDefinition Width="5"/>
                                        <ColumnDefinition Width="20"/>
                                        <ColumnDefinition Width="45"/>
                                        <ColumnDefinition Width="40"/>
                                        <ColumnDefinition Width="20"/>
                                        <ColumnDefinition Width="70"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="25"/>
                                        <RowDefinition Height="25"/>
                                        <RowDefinition Height="25"/>
                                        <RowDefinition Height="25"/>
                                        <RowDefinition Height="25"/>
                                        <RowDefinition Height="25"/>
                                        <RowDefinition Height="25"/>
                                        <RowDefinition Height="25"/>
                                        <RowDefinition Height="25"/>
                                        <RowDefinition Height="25"/>
                                        <RowDefinition Height="25"/>
                                        <RowDefinition Height="25"/>
                                    </Grid.RowDefinitions>
                                    <!--#region Ряд №0 -->
                                    <Border Grid.Column="5" Grid.Row="0" Grid.ColumnSpan="9">
                                        <DockPanel>
                                            <TextBlock Text="З/з.№" FontSize="14" Margin="5,0"/>
                                            <CheckBox IsChecked="{Binding IsCell_16003}" DockPanel.Dock="Left" VerticalAlignment="Center"/>
                                            <TextBox Text="{Binding Cell_16003}" IsEnabled="{Binding IsCell_16003}" DockPanel.Dock="Left"/>
                                        </DockPanel>
                                    </Border>
                                    <!--#endregion-->
                                    <!--#region Ряд №1 -->
                                    <Border Grid.Column="0" Grid.Row="1"/>
                                    <Border Grid.Column="1" Grid.Row="1"/>
                                    <Border Grid.Column="2" Grid.Row="1"/>
                                    <Border Grid.Column="3" Grid.Row="1"/>
                                    <Border Grid.Column="4" Grid.Row="1"/>
                                    <Border Grid.Column="5" Grid.Row="1" Grid.ColumnSpan="9" Grid.RowSpan="3">
                                        <DockPanel LastChildFill="False" VerticalAlignment="Center">
                                            <CheckBox Content="Записать имя файла в основную надпись" IsChecked="{Binding IsCell_2}" DockPanel.Dock="Top" VerticalAlignment="Center"/>
                                            <CheckBox IsChecked="{Binding IsCell_2Height}" IsEnabled="{Binding IsCell_2}" Content="Указать высоту текста:"
                                                      DockPanel.Dock="Left" VerticalAlignment="Center"/>
                                            <TextBox Text="{Binding Cell_2Height}" IsEnabled="{Binding IsCell_2Height}" DockPanel.Dock="Left" Height="25" Width="30" Margin="2"
                                                      PreviewTextInput="TB_PreviewTextInput_OnlyNumber"/>
                                        </DockPanel>
                                    </Border>
                                    <!--#endregion-->
                                    <!--#region Ряд №2 -->
                                    <Border Grid.Column="0" Grid.Row="2"/>
                                    <Border Grid.Column="1" Grid.Row="2"/>
                                    <Border Grid.Column="2" Grid.Row="2"/>
                                    <Border Grid.Column="3" Grid.Row="2"/>
                                    <Border Grid.Column="4" Grid.Row="2"/>
                                    <!--#endregion-->
                                    <!--#region Ряд №3 -->
                                    <Border Grid.Column="0" Grid.Row="3"/>
                                    <Border Grid.Column="1" Grid.Row="3"/>
                                    <Border Grid.Column="2" Grid.Row="3"/>
                                    <Border Grid.Column="3" Grid.Row="3"/>
                                    <Border Grid.Column="4" Grid.Row="3"/>
                                    <!--#endregion-->
                                    <!--#region Ряд №4 -->
                                    <Border Grid.Column="0" Grid.Row="4"/>
                                    <Border Grid.Column="1" Grid.Row="4"/>
                                    <Border Grid.Column="2" Grid.Row="4"/>
                                    <Border Grid.Column="3" Grid.Row="4"/>
                                    <Border Grid.Column="4" Grid.Row="4"/>
                                    <!--Наименование заказа-->
                                    <Border Grid.Column="5" Grid.Row="4" Grid.RowSpan="5">
                                        <DockPanel>
                                            <DockPanel DockPanel.Dock="Bottom" LastChildFill="False">
                                                <CheckBox IsChecked="{Binding IsCell_1Height}" IsEnabled="{Binding IsCell_1}"
                                                          Content="Указать высоту текста:" DockPanel.Dock="Left" VerticalAlignment="Center"/>
                                                <TextBox Text="{Binding Cell_1Height}" IsEnabled="{Binding IsCell_1Height}" DockPanel.Dock="Left"
                                                         Height="25" Width="30" Margin="2" PreviewTextInput="TB_PreviewTextInput_OnlyNumber"/>
                                            </DockPanel>
                                            <CheckBox IsChecked="{Binding IsCell_1}" DockPanel.Dock="Left" VerticalAlignment="Center"/>
                                            <TextBox Text="{Binding Cell_1}" IsEnabled="{Binding IsCell_1}" DockPanel.Dock="Left" TextWrapping="Wrap" AcceptsReturn="True"/>
                                        </DockPanel>
                                    </Border>
                                    <Border Grid.Column="6" Grid.Row="4" Grid.ColumnSpan="4">
                                        <TextBlock Text="Лит." HorizontalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Column="10" Grid.Row="4" Grid.ColumnSpan="2">
                                        <TextBlock Text="Масса" HorizontalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Column="12" Grid.Row="4" Grid.ColumnSpan="2">
                                        <TextBlock Text="Масштаб" HorizontalAlignment="Center"/>
                                    </Border>
                                    <!--#endregion-->
                                    <!--#region Ряд №5 -->
                                    <Border Grid.Column="0" Grid.Row="5">
                                        <TextBlock Text="Изм." HorizontalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Column="1" Grid.Row="5">
                                        <TextBlock Text="Лист" HorizontalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Column="2" Grid.Row="5">
                                        <TextBlock Text="№ докум." HorizontalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Column="3" Grid.Row="5">
                                        <TextBlock Text="Подп." HorizontalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Column="4" Grid.Row="5">
                                        <TextBlock Text="Дата" HorizontalAlignment="Center"/>
                                    </Border>
                                    <Border Grid.Column="6" Grid.Row="5" Grid.RowSpan="3"/>
                                    <Border Grid.Column="7" Grid.Row="5" Grid.RowSpan="3"/>
                                    <Border Grid.Column="8" Grid.Row="5" Grid.ColumnSpan="2" Grid.RowSpan="3"/>
                                    <Border Grid.Column="10" Grid.Row="5" Grid.ColumnSpan="2" Grid.RowSpan="3"/>
                                    <Border Grid.Column="12" Grid.Row="5" Grid.ColumnSpan="2" Grid.RowSpan="3"/>
                                    <!--#endregion-->
                                    <!--#region Ряд №6 -->
                                    <Border Grid.Column="0" Grid.Row="6" Grid.ColumnSpan="2">
                                        <TextBlock Text="Разраб." Margin="3,0"/>
                                    </Border>
                                    <Border Grid.Column="2" Grid.Row="6"/>
                                    <Border Grid.Column="3" Grid.Row="6"/>
                                    <Border Grid.Column="4" Grid.Row="6"/>
                                    <!--#endregion-->
                                    <!--#region Ряд №7 -->
                                    <Border Grid.Column="0" Grid.Row="7" Grid.ColumnSpan="2">
                                        <TextBlock Text="Пров." Margin="3,0"/>
                                    </Border>
                                    <Border Grid.Column="2" Grid.Row="7"/>
                                    <Border Grid.Column="3" Grid.Row="7"/>
                                    <Border Grid.Column="4" Grid.Row="7"/>
                                    <!--#endregion-->
                                    <!--#region Ряд №8 -->
                                    <Border Grid.Column="0" Grid.Row="8" Grid.ColumnSpan="2">
                                        <TextBlock Text="Рук. КБ." Margin="3,0"/>
                                    </Border>
                                    <Border Grid.Column="2" Grid.Row="8"/>
                                    <Border Grid.Column="3" Grid.Row="8"/>
                                    <Border Grid.Column="4" Grid.Row="8"/>
                                    <Border Grid.Column="6" Grid.Row="8" Grid.ColumnSpan="5">
                                        <DockPanel>
                                            <TextBlock DockPanel.Dock="Left" Text="Лист" FontSize="14" Margin="2,0"/>
                                            <CheckBox IsChecked="{Binding IsCell_16001}" DockPanel.Dock="Left" VerticalAlignment="Center"/>
                                            <TextBox Text="{Binding Cell_16001}" IsEnabled="{Binding IsCell_16001}" DockPanel.Dock="Left"/>
                                        </DockPanel>
                                    </Border>
                                    <Border Grid.Column="11" Grid.Row="8" Grid.ColumnSpan="3">
                                        <DockPanel>
                                            <TextBlock DockPanel.Dock="Left" Text="Инв.№" FontSize="14" Margin="2,0"/>
                                            <CheckBox IsChecked="{Binding IsCell_16002}" DockPanel.Dock="Left" VerticalAlignment="Center"/>
                                            <TextBox Text="{Binding Cell_16002}" IsEnabled="{Binding IsCell_16002}" DockPanel.Dock="Left"/>
                                        </DockPanel>
                                    </Border>
                                    <!--#endregion-->
                                    <!--#region Ряд №9 -->
                                    <Border Grid.Column="0" Grid.Row="9" Grid.ColumnSpan="2">
                                        <TextBlock Text="Нач. отд." Margin="3,0"/>
                                    </Border>
                                    <Border Grid.Column="2" Grid.Row="9"/>
                                    <Border Grid.Column="3" Grid.Row="9"/>
                                    <Border Grid.Column="4" Grid.Row="9"/>
                                    <Border Grid.Column="5" Grid.Row="9" Grid.RowSpan="3"/>
                                    <Border Grid.Column="6" Grid.Row="9" Grid.ColumnSpan="8" Grid.RowSpan="3"/>
                                    <!--#endregion-->
                                    <!--#region Ряд №10 -->
                                    <Border Grid.Column="0" Grid.Row="10" Grid.ColumnSpan="2">
                                        <TextBlock Text="Н. контр." Margin="3,0"/>
                                    </Border>
                                    <Border Grid.Column="2" Grid.Row="10"/>
                                    <Border Grid.Column="3" Grid.Row="10"/>
                                    <Border Grid.Column="4" Grid.Row="10"/>
                                    <!--#endregion-->
                                    <!--#region Ряд №11 -->
                                    <Border Grid.Column="0" Grid.Row="11" Grid.ColumnSpan="2">
                                        <TextBlock Text="Гл. инж." Margin="3,0"/>
                                    </Border>
                                    <Border Grid.Column="2" Grid.Row="11"/>
                                    <Border Grid.Column="3" Grid.Row="11"/>
                                    <Border Grid.Column="4" Grid.Row="11"/>
                                    <!--#endregion-->

                                </Grid>

                                <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Center">
                                    <Button Content="Изменить штамп" Padding="4,2" Margin="10,2" Command="{Binding EditStampCommand}"/>
                                    <Button Content="Отмена" Padding="4,2" Margin="10,2" Command="{Binding EditStampCancelCommand}"/>
                                </StackPanel>
                            </Grid>

                        </TabItem>
                        <!--Нумерация листов-->
                        <TabItem Header="Нумерация листов">
                            <TabItem.DataContext>
                                <WorkingWithFiles:SheetNumbering/>
                            </TabItem.DataContext>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <StackPanel Grid.Row="0" Orientation="Vertical">
                                    <DockPanel LastChildFill="True">
                                        <TextBlock DockPanel.Dock="Top" Text="Получить чертежи:" Margin="2"/>
                                        <RadioButton IsChecked="{Binding IsFolderAllCdw}" DockPanel.Dock="Top" GroupName="Нумерация листов. Способ получения чертежей"
                                                     Content="из папки"/>
                                        <Button IsEnabled="{Binding IsFolderAllCdw}" DockPanel.Dock="Left" Width="Auto" Content="Выбрать папку" Padding="4,2" Margin="2"
                                                Command="{Binding OpenFolderCommand}"/>
                                        <TextBox IsEnabled="{Binding IsFolderAllCdw}" Text="{Binding PathFolderAllCdw}" DockPanel.Dock="Left" MinWidth="200" Margin="2,1"/>
                                    </DockPanel>
                                    <DockPanel LastChildFill="False">
                                        <RadioButton IsChecked="{Binding IsPathsFileCdw}" DockPanel.Dock="Top" GroupName="Нумерация листов. Способ получения чертежей"
                                                     Content="выбором файлов"/>
                                        <Button IsEnabled="{Binding IsPathsFileCdw}" DockPanel.Dock="Left" Width="Auto" Content="Выбрать чертежи" Padding="4,2" Margin="2"
                                                Command="{Binding GetPathFilesCommand}"/>
                                    </DockPanel>
                                </StackPanel>
                                <DockPanel Grid.Row="1" LastChildFill="False" VerticalAlignment="Top">
                                    <TextBlock Text="Список чертежей для изменения:" Margin="2" DockPanel.Dock="Top"/>
                                    <ListBox ItemsSource="{Binding PathsFileCdw}" DockPanel.Dock="Top" MinHeight="100"/>
                                    <TextBlock Text="Начать с номера: " DockPanel.Dock="Left"/>
                                    <TextBox Text="{Binding StartNumber}" DockPanel.Dock="Left" Height="25" Width="50" Margin="2" PreviewTextInput="TB_PreviewTextInput_OnlyNumber"/>
                                </DockPanel>
                                <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center">
                                    <Button Content="Нумеровать" Padding="4,2" Margin="10,2" Command="{Binding SheetNumberingCommand}"/>
                                    <Button Content="Отмена" Padding="4,2" Margin="10,2" Command="{Binding SheetNumberingCancelCommand}"/>
                                </StackPanel>
                            </Grid>
                        </TabItem>
                        <!--Записать основную надпись в имя файла-->
                        <TabItem Header="Основную надпись в имя файла">
                            <TabItem.DataContext>
                                <WorkingWithFiles:TitleBlockToFileName/>
                            </TabItem.DataContext>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <StackPanel Grid.Row="0" Orientation="Vertical">
                                    <DockPanel LastChildFill="True">
                                        <TextBlock DockPanel.Dock="Top" Text="Получить чертежи:" Margin="2"/>
                                        <RadioButton IsChecked="{Binding IsFolderAllCdw}" DockPanel.Dock="Top"
                                                     GroupName="Записать основную надпись в имя файла. Способ получения чертежей" Content="из папки"/>
                                        <Button IsEnabled="{Binding IsFolderAllCdw}" DockPanel.Dock="Left" Width="Auto" Content="Выбрать папку" Padding="4,2" Margin="2"
                                                Command="{Binding OpenFolderCommand}"/>
                                        <TextBox IsEnabled="{Binding IsFolderAllCdw}" Text="{Binding PathFolderAllCdw}" DockPanel.Dock="Left" MinWidth="200" Margin="2,1"/>
                                    </DockPanel>
                                    <DockPanel LastChildFill="False">
                                        <RadioButton IsChecked="{Binding IsPathsFileCdw}" DockPanel.Dock="Top"
                                                    GroupName="Записать основную надпись в имя файла. Способ получения чертежей" Content="выбором файлов"/>
                                        <Button IsEnabled="{Binding IsPathsFileCdw}" DockPanel.Dock="Left" Width="Auto" Content="Выбрать чертежи" Padding="4,2" Margin="2"
                                                Command="{Binding GetPathFilesCommand}"/>
                                    </DockPanel>
                                </StackPanel>
                                <DockPanel Grid.Row="1" LastChildFill="False" VerticalAlignment="Top">
                                    <TextBlock Text="Список чертежей для изменения:" Margin="2" DockPanel.Dock="Top"/>
                                    <ListBox ItemsSource="{Binding PathsFileCdw}" DockPanel.Dock="Top" MinHeight="100"/>
                                </DockPanel>
                                <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center">
                                    <Button Content="Записать" Padding="4,2" Margin="10,2" Command="{Binding WriteTitleBlockToFileNameCommand}"/>
                                    <Button Content="Отмена" Padding="4,2" Margin="10,2" Command="{Binding WriteTitleBlockToFileNameCancelCommand}"/>
                                </StackPanel>
                            </Grid>
                        </TabItem>
                    </TabControl>
                    <StackPanel Grid.Row="1" Orientation="Vertical" VerticalAlignment="Bottom">
                        <ProgressBar Value="{Binding Progress_Bar}" Height="10"/>
                        <Label Content="Журнал работы приложения:"/>
                    </StackPanel>
                    <TextBox Grid.Row="2" Text="{Binding Logging}" IsReadOnly="True" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Visible" TextChanged="TextBox_TextChanged"/>
                </Grid>
            </TabItem>
            <!--Разное-->
            <TabItem Header="Разное">
                <TabControl>
                    <TabItem Header="Разделки">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName ="Loaded">
                                <i:InvokeCommandAction Command ="{Binding LoadedTabCommand}"/>
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                        <TabItem.DataContext>
                            <Sundry:Welding/>
                        </TabItem.DataContext>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="150"/>
                                <RowDefinition/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>
                            <StackPanel Orientation="Horizontal" Grid.Row="0">
                                <!--Госты-->
                                <StackPanel Orientation="Vertical" Margin="5,0,0,0">
                                    <TextBlock Text="ГОСТ" HorizontalAlignment="Center"/>
                                    <ListBox x:Name="WeldGOSTs" Height="100" Width="70" ItemsSource="{Binding WeldGOSTs}"
                                        SelectedItem="{Binding SelectGOST}" SelectionChanged="WeldGOSTs_SelectionChanged" HorizontalAlignment="Center"/>
                                </StackPanel>
                                <!--Условные обозначения сварных швов-->
                                <StackPanel Orientation="Vertical" Margin="5,0,0,0">
                                    <TextBlock Text="Обозначение" HorizontalAlignment="Center"/>
                                    <ListBox x:Name="NameWeldJoints" Height="100" Width="80" ItemsSource="{Binding NameWeldJoints}"
                                        SelectedItem="{Binding SelectNameWeldJoints}" SelectionChanged="NameWeldJoints_SelectionChanged"  HorizontalAlignment="Center"/>
                                </StackPanel>
                                <!--Способ сварки-->
                                <StackPanel Orientation="Vertical" Margin="5,0,0,0">
                                    <TextBlock Text="Способ сварки" HorizontalAlignment="Center"/>
                                    <ListBox x:Name="WeldingMethod" Height="100" Width="90" ItemsSource="{Binding WeldingMethod}"
                                        SelectedItem="{Binding SelectWeldingMethod}" SelectionChanged="WeldingMethod_SelectionChanged" HorizontalAlignment="Center"/>
                                </StackPanel>
                                <!--Выбор расположения главной детали-->
                                <StackPanel Orientation="Vertical" Margin="5,0,0,0">
                                    <TextBlock Text="Выбор расположения главной детали" HorizontalAlignment="Center"/>
                                    <Canvas Width="200" Height="100" Margin="5" HorizontalAlignment="Center">
                                        <Polygon Fill="Gray"  Points="0,40,40,40,40,30,20,0,0,0" Stroke="Black"/>
                                        <RadioButton GroupName="LocationPart" IsChecked="{Binding IsLocationPart, Converter={StaticResource radioBoolConverterToLocationPart},
                                        ConverterParameter=Лево_Верх}" Canvas.Left="9.5" Canvas.Top="14.5">
                                            <RadioButton.ToolTip>
                                                <TextBlock Text="Лево верх"/>
                                            </RadioButton.ToolTip>
                                        </RadioButton>
                                        <Polygon Fill="Gray"  Points="0,50,40,50,40,60,20,90,0,90" Stroke="Black"/>
                                        <RadioButton GroupName="LocationPart" IsChecked="{Binding IsLocationPart, Converter={StaticResource radioBoolConverterToLocationPart},
                                        ConverterParameter=Лево_Низ}" Canvas.Left="9.5" Canvas.Top="64.5">
                                            <RadioButton.ToolTip>
                                                <TextBlock Text="Лево Низ"/>
                                            </RadioButton.ToolTip>
                                        </RadioButton>
                                        <Polygon Fill="Gray"  Points="90,40,50,40,50,30,70,0,90,0" Stroke="Black"/>
                                        <RadioButton GroupName="LocationPart" IsChecked="{Binding IsLocationPart, Converter={StaticResource radioBoolConverterToLocationPart},
                                        ConverterParameter=Право_Верх}" Canvas.Left="69.5" Canvas.Top="14.5">
                                            <RadioButton.ToolTip>
                                                <TextBlock Text="Право Верх"/>
                                            </RadioButton.ToolTip>
                                        </RadioButton>
                                        <Polygon Fill="Gray"  Points="90,50,50,50,50,60,70,90,90,90" Stroke="Black"/>
                                        <RadioButton GroupName="LocationPart" IsChecked="{Binding IsLocationPart, Converter={StaticResource radioBoolConverterToLocationPart},
                                    ConverterParameter=Право_Низ}" Canvas.Left="69.5" Canvas.Top="64.5">
                                            <RadioButton.ToolTip>
                                                <TextBlock Text="Право Низ"/>
                                            </RadioButton.ToolTip>
                                        </RadioButton>
                                        <Polygon Fill="Gray"  Points="140,0,140,40,130,40,100,20,100,0" Stroke="Black"/>
                                        <RadioButton GroupName="LocationPart" IsChecked="{Binding IsLocationPart, Converter={StaticResource radioBoolConverterToLocationPart},
                                    ConverterParameter=Верх_Лево}" Canvas.Left="114.5" Canvas.Top="9.5">
                                            <RadioButton.ToolTip>
                                                <TextBlock Text="Верх Лево"/>
                                            </RadioButton.ToolTip>
                                        </RadioButton>
                                        <Polygon Fill="Gray"  Points="140,90,140,50,130,50,100,70,100,90" Stroke="Black"/>
                                        <RadioButton GroupName="LocationPart" IsChecked="{Binding IsLocationPart, Converter={StaticResource radioBoolConverterToLocationPart},
                                    ConverterParameter=Низ_Лево}" Canvas.Left="114.5" Canvas.Top="69.5">
                                            <RadioButton.ToolTip>
                                                <TextBlock Text="Низ Лево"/>
                                            </RadioButton.ToolTip>
                                        </RadioButton>
                                        <Polygon Fill="Gray"  Points="150,0,150,40,160,40,190,20,190,0" Stroke="Black"/>
                                        <RadioButton GroupName="LocationPart" IsChecked="{Binding IsLocationPart, Converter={StaticResource radioBoolConverterToLocationPart},
                                    ConverterParameter=Верх_Право}" Canvas.Left="164.5" Canvas.Top="9.5">
                                            <RadioButton.ToolTip>
                                                <TextBlock Text="Верх Право"/>
                                            </RadioButton.ToolTip>
                                        </RadioButton>
                                        <Polygon Fill="Gray"  Points="150,90,150,50,160,50,190,70,190,90" Stroke="Black"/>
                                        <RadioButton GroupName="LocationPart" IsChecked="{Binding IsLocationPart, Converter={StaticResource radioBoolConverterToLocationPart},
                                    ConverterParameter=Низ_Право}" Canvas.Left="164.5" Canvas.Top="69.5">
                                            <RadioButton.ToolTip>
                                                <TextBlock Text="Низ Право"/>
                                            </RadioButton.ToolTip>
                                        </RadioButton>
                                    </Canvas>
                                </StackPanel>

                                <!--Выбор типа перехода деталей-->
                                <StackPanel Orientation="Vertical" Margin="5,0,0,0">
                                    <TextBlock Text="Выбор типа перехода деталей:"/>
                                    <StackPanel Orientation="Horizontal">
                                        <CheckBox Content="длина перехода = высота перехода умноженная на К" VerticalAlignment="Center"/>
                                        <TextBox Text="" Width="25" Height="25" VerticalAlignment="Center" HorizontalContentAlignment="Center" Margin="5,0"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                                        <ComboBox ItemsSource="{Binding TransitionTypes}" SelectedItem="{Binding SelectTransitionTypesFirstUP}"/>
                                        <TextBlock Text="- верх главной детали" Margin="5,0,0,0"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                                        <ComboBox ItemsSource="{Binding TransitionTypes}" SelectedItem="{Binding SelectTransitionTypesFirstBottom}"/>
                                        <TextBlock Text="- низ главной детали" Margin="5,0,0,0"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                                        <ComboBox ItemsSource="{Binding TransitionTypes}" SelectedItem="{Binding SelectTransitionTypesSecondUP}"/>
                                        <TextBlock Text="- верх второстепенной детали" Margin="5,0,0,0"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                                        <ComboBox ItemsSource="{Binding TransitionTypes}" SelectedItem="{Binding SelectTransitionTypesSecondBottom}"/>
                                        <TextBlock Text="- низ второстепенной детали" Margin="5,0,0,0"/>
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Grid.Row="1" Margin="5,0,0,0">
                                <StackPanel Orientation="Vertical">
                                    <TextBlock Text="Какую деталь чертить:"/>
                                    <RadioButton Content="Главную деталь" GroupName="Number part" IsChecked="{Binding NumberPart}"/>
                                    <RadioButton Content="Второстепенную деталь" GroupName="Number part"/>
                                </StackPanel>
                                <StackPanel Orientation="Vertical" Margin="5,0,0,0">
                                    <CheckBox Content="Чертить размеры" IsChecked="{Binding IsDrawingDimensions}"/>
                                    <CheckBox Content="Объединить в макроэлемент" IsChecked="{Binding IsMacro}"/>
                                </StackPanel>
                                <DockPanel Margin="5,0,0,0" VerticalAlignment="Top">
                                    <TextBlock DockPanel.Dock="Top" Text="Наименование сечения/узла"/>
                                    <TextBox DockPanel.Dock="Left" x:Name="Tb_NameCut" Text="{Binding NameCut, UpdateSourceTrigger=PropertyChanged}" Width="60" Height="25"/>
                                    <Button DockPanel.Dock="Left" x:Name="B_CurTurned" Content="Повёрнуто" Click="B_CurTurned_Click" Width="80" Height="25">
                                        <Button.ToolTip>
                                            <TextBlock Text="Добавляет значёк повернуто в наименование сечения/узла"/>
                                        </Button.ToolTip>
                                    </Button>
                                </DockPanel>
                                <StackPanel Orientation="Vertical" Margin="5,0,0,0">
                                    <TextBlock Text="Вставить сечение в:"/>
                                    <RadioButton Content="Активный вид" GroupName="WhichView" IsChecked="True"/>
                                    <RadioButton Content="Подобрать по масштабу" GroupName="WhichView"  IsChecked="{Binding IsSearchView}"/>
                                    <!--Масштаб-->
                                    <StackPanel Orientation="Horizontal" Margin="0,5">
                                        <TextBlock Text="Масштаб" Margin="0,0,5,0"/>
                                        <TextBox Text="{Binding LeftScale, UpdateSourceTrigger=PropertyChanged}" Width="30" Height="25" IsEnabled="{Binding IsSearchView}"
                                                 HorizontalContentAlignment="Center">
                                            <TextBox.ToolTip>
                                                <TextBlock>
                                                   Масштаб должен быть числом и оно должно быть больше нуля.
                                                   <LineBreak/>
                                                   Дробная часть должна разделяться запятой.
                                                </TextBlock>
                                            </TextBox.ToolTip>
                                        </TextBox>
                                        <TextBlock Text=":" Margin="5,0"/>
                                        <TextBox Text="{Binding RightScale, UpdateSourceTrigger=PropertyChanged}" Width="30" Height="25" IsEnabled="{Binding IsSearchView}"
                                                 HorizontalContentAlignment="Center">
                                            <TextBox.ToolTip>
                                                <TextBlock>
                                                    Масштаб должен быть числом и оно должно быть больше нуля.
                                                    <LineBreak/>
                                                    Дробная часть должна разделяться запятой.
                                                </TextBlock>
                                            </TextBox.ToolTip>
                                        </TextBox>
                                    </StackPanel>
                                </StackPanel>
                                <StackPanel Orientation="Vertical" Margin="5,0,0,0">
                                    <StackPanel Orientation="Horizontal"  HorizontalAlignment="Center">
                                        <TextBlock Text="Толщина:"/>
                                        <TextBox Text="{Binding ThicknessStr, UpdateSourceTrigger=PropertyChanged}" Width="40" Height="25" Padding="2" Margin="2"
                                             HorizontalContentAlignment="Center">
                                            <TextBox.ToolTip>
                                                <TextBlock>
                                                Толщина должна быть числом и оно должно быть больше нуля.
                                                <LineBreak/>
                                                Дробная часть должна разделяться запятой.
                                                </TextBlock>
                                            </TextBox.ToolTip>
                                        </TextBox>
                                    </StackPanel>
                                    <Button Content="Начертить" Command="{Binding TestCommand}"/>
                                </StackPanel>
                            </StackPanel>
                            <DockPanel Grid.Row="2">
                                <TextBlock DockPanel.Dock="Top" Text="Список сварных швов:" Margin="0,2"/>
                                <ListView DockPanel.Dock="Top" x:Name="WeldDates" ItemsSource="{Binding WeldDates}" SelectedItem="{Binding SelectWeldDates}">
                                    <ListView.View>
                                        <GridView>
                                            <GridViewColumn DisplayMemberBinding="{Binding NameGost}">ГОСТ</GridViewColumn>
                                            <GridViewColumn DisplayMemberBinding="{Binding NameWeldJoint}">Обозначение соединения</GridViewColumn>
                                            <GridViewColumn DisplayMemberBinding="{Binding WeldingMethod}">Способ сварки</GridViewColumn>
                                            <GridViewColumn DisplayMemberBinding="{Binding RangeThickness}">Толщины</GridViewColumn>
                                            <GridViewColumn DisplayMemberBinding="{Binding ParamC}">c, притупление</GridViewColumn>
                                            <GridViewColumn DisplayMemberBinding="{Binding ParamA}">a, угол</GridViewColumn>
                                            <GridViewColumn DisplayMemberBinding="{Binding RangeUserAngle}">Углы</GridViewColumn>
                                        </GridView>
                                    </ListView.View>
                                </ListView>
                            </DockPanel>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Заказ">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="50"/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="Открыть заказ" Margin="5"/>
                                <TextBox Text="{Binding OrderRequest, NotifyOnTargetUpdated=True, UpdateSourceTrigger=PropertyChanged}" Height="25" Width="120" VerticalContentAlignment="Center" Margin="5"/>
                                <TextBlock Text="Найти марку" Margin="5"/>
                                <TextBox Text="{Binding MarkRequest, NotifyOnTargetUpdated=True, UpdateSourceTrigger=PropertyChanged}" Height="25" Width="120" VerticalContentAlignment="Center" Margin="5"/>
                                <TextBlock Text="Найти позицию" Margin="5"/>
                                <TextBox Text="{Binding PosRequest, NotifyOnTargetUpdated=True, UpdateSourceTrigger=PropertyChanged}" Height="25" Width="120" VerticalContentAlignment="Center" Margin="5"/>
                            </StackPanel>
                            <Grid Grid.Row="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="300"/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <ListBox Grid.Column="0" ItemsSource="{Binding OrdersPath}" SelectedItem="{Binding OrderSelected}">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding Name}">
                                                <i:Interaction.Triggers>
                                                    <i:EventTrigger EventName ="MouseDoubleClick">
                                                        <i:InvokeCommandAction 
                                                            Command ="{Binding DataContext.RunProcessCommand, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                            CommandParameter="{Binding FullName}"/>
                                                    </i:EventTrigger>
                                                </i:Interaction.Triggers>
                                            </Label>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                                <TabControl Grid.Column="1" TabStripPlacement="Left" SelectedIndex="{Binding OrderSelectPath}">
                                    <TabItem Header="Чертежи компас" Height="30">
                                        <StackPanel Orientation="Horizontal">
                                            <ListBox ItemsSource="{Binding DrawingKompasAssembly}" Width="300">
                                                <ListBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <Label Content="{Binding Name}">
                                                            <i:Interaction.Triggers>
                                                                <i:EventTrigger EventName ="MouseDoubleClick">
                                                                    <i:InvokeCommandAction 
                                                                        Command ="{Binding DataContext.RunProcessCommand, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                                        CommandParameter="{Binding FullName}"/>
                                                                </i:EventTrigger>
                                                            </i:Interaction.Triggers>
                                                        </Label>
                                                    </DataTemplate>
                                                </ListBox.ItemTemplate>
                                            </ListBox>
                                            <ListBox ItemsSource="{Binding DrawingKompasPart}"  Width="300">
                                                <ListBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <Label Content="{Binding Name}">
                                                            <i:Interaction.Triggers>
                                                                <i:EventTrigger EventName ="MouseDoubleClick">
                                                                    <i:InvokeCommandAction 
                                                                        Command ="{Binding DataContext.RunProcessCommand, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                                        CommandParameter="{Binding FullName}"/>
                                                                </i:EventTrigger>
                                                            </i:Interaction.Triggers>
                                                        </Label>
                                                    </DataTemplate>
                                                </ListBox.ItemTemplate>
                                            </ListBox>
                                        </StackPanel>
                                    </TabItem>
                                    <TabItem Header="Завершенные чертежи" Height="30">
                                        <ListBox ItemsSource="{Binding DrawingCompleted}">
                                            <ListBox.ItemTemplate>
                                                <DataTemplate>
                                                    <Label Content="{Binding Name}">
                                                        <i:Interaction.Triggers>
                                                            <i:EventTrigger EventName ="MouseDoubleClick">
                                                                <i:InvokeCommandAction 
                                                                        Command ="{Binding DataContext.RunProcessCommand, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                                        CommandParameter="{Binding FullName}"/>
                                                            </i:EventTrigger>
                                                        </i:Interaction.Triggers>
                                                    </Label>
                                                </DataTemplate>
                                            </ListBox.ItemTemplate>
                                        </ListBox>
                                    </TabItem>
                                    <TabItem Header="3D" Height="30">
                                        <StackPanel Orientation="Horizontal">
                                            <ListBox ItemsSource="{Binding Model3DAssembly}"  Width="300">
                                                <ListBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <Label Content="{Binding Name}">
                                                            <i:Interaction.Triggers>
                                                                <i:EventTrigger EventName ="MouseDoubleClick">
                                                                    <i:InvokeCommandAction 
                                                                        Command ="{Binding DataContext.RunProcessCommand, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                                        CommandParameter="{Binding FullName}"/>
                                                                </i:EventTrigger>
                                                            </i:Interaction.Triggers>
                                                        </Label>
                                                    </DataTemplate>
                                                </ListBox.ItemTemplate>
                                            </ListBox>
                                            <ListBox ItemsSource="{Binding Model3DPart}"  Width="300">
                                                <ListBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <Label Content="{Binding Name}" MouseMove="Label_MouseMove">
                                                            <i:Interaction.Triggers>
                                                                <i:EventTrigger EventName ="MouseDoubleClick">
                                                                    <i:InvokeCommandAction 
                                                                        Command ="{Binding DataContext.RunProcessCommand, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                                                                        CommandParameter="{Binding FullName}"/>
                                                                </i:EventTrigger>
                                                            </i:Interaction.Triggers>
                                                        </Label>
                                                    </DataTemplate>
                                                </ListBox.ItemTemplate>
                                            </ListBox>
                                        </StackPanel>
                                    </TabItem>
                                </TabControl>
                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Получить позиции">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="30"/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>

                            <StackPanel Grid.Row="1" Orientation="Vertical">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Папка:"/>
                                    <TextBox Text="" Width="120"/>
                                    <Button Content="Открыть" Command=""/>
                                    <Button Content="Получить" Command=""/>
                                    <Button Content="Отмена" Command=""/>
                                    <Button Content="Сохранить в эксель" Command=""/>
                                </StackPanel>
                            </StackPanel>
                        </Grid>

                    </TabItem>
                </TabControl>
            </TabItem>

        </TabControl>
        <StatusBar Grid.Row="2">
            <TextBlock Text="{Binding StatusBar}" VerticalAlignment="Center"/>
        </StatusBar>
    </Grid>
</Window>
